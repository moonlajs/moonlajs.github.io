<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport"
     content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=no"/>
  <title>pdf pdfjs C</title>
  <style type="text/css">
    canvas {
      width: 100%;
      height: 100%;
      
    }
	
	
	html{
		margin:0;
		padding:0;
		background: #fff;
	}
	 body{
		margin:0;
		padding:0;
		background: #fff;
	}
.scroll{
    position: absolute;
    overflow: auto;
    -webkit-overflow-scrolling: touch;
    top: 0;
    left: 0;
	bottom: 0;
    right: 0;
}
.close::before {
    content: "\2716";
}

@media screen and (max-width: 586px) {
    .close {
        width:10vw !important;
		height: 10vw;
		top: 2vw !important;
	
    }
}
	.handout_wrap_inner-4345{
	 position: fixed;
	 right: 0;
	 bottom: 0;
	 left: 0;
	 top: 0;
	 -webkit-overflow-scrolling: touch;
	 overflow-y: scroll;
	 overflow-x: hidden;
	
	}
  </style>

  
</head>
<body>



  <div class="scroll" style="">
        <div class="phone_panel"><div class="p-index main phoneBox" id="con" style="display: block;">
     
            <div class="nr" id="nr" style="touch-action: none;">

            <section class="main-page z-current" paged="1" style="transition: none 0s ease 0s;"><div class="m-img" id="page1"><div class="edit_wrapper" data-scene-id="8898454"><ul eqx-edit-destroy="" id="edit_area134712" paste-element="" class="edit_area weebly-content-area weebly-area-active">
			
			<li comp-drag="" comp-rotate="" class="comp-resize comp-rotate inside wsite-image" id="inside_6349666333" num="1" ctype="4" comp-resize="" data-event="1120601" style="width: 300px; height: 100px; left: 136px; top: 220px; z-index: 3; transform: rotateZ(0deg);"><div class="element-box" style="box-shadow: rgba(0, 0, 0, 0.5) 0px 0px 0px; border-color: rgb(0, 0, 0); padding-bottom: 0px; border-style: solid; z-index: 3; height: 100%; text-align: left; border-radius: 0px; left: 136px; font-size: 12px; color: rgb(103, 103, 103); transform: none; top: 220px; border-width: 0px; padding-top: 0px; letter-spacing: 0px; width: 100%; line-height: 1; opacity: 1;">
				<h1>1-太平人寿个人业务系列2016年第十四届业务精英高峰会荣誉方案.pdf</h1>
				<div class="element-box-contents" style="width: 100%; height: 100%;"  index='pdf' data-index='0'><img id="6349666333" ctype="4" class="element comp_image editable-image" src="" style="cursor: inherit; border-radius: 0px; width: 100%; height: 100%; position: absolute; top: 0px; left: 0px;"></div></div></li>
			
			<li comp-drag="" comp-rotate="" class="comp-resize comp-rotate inside wsite-image" id="inside_1014494080" num="1" ctype="4" comp-resize="" data-event="1120601" style="width: 300px; height: 100px; left: 141px; top: 28px; z-index: 6; transform: rotateZ(0deg);"><div class="element-box" style="box-shadow: rgba(0, 0, 0, 0.5) 0px 0px 0px; border-color: rgb(0, 0, 0); padding-bottom: 0px; border-style: solid; z-index: 6; height: 100%; text-align: left; border-radius: 0px; left: 141px; font-size: 12px; color: rgb(103, 103, 103); transform: none; top: 28px; border-width: 0px; padding-top: 0px; letter-spacing: 0px; width: 100%; line-height: 1; opacity: 1;">
				<h1>个险每日聚焦0525.pdf</h1>
				<div class="element-box-contents" style="width: 100%; height: 100%;"  index='pdf' data-index='2'><img id="1014494080" ctype="4" class="element comp_image editable-image" src="" style="cursor: inherit; border-radius: 0px; width: 100%; height: 100%; position: absolute; top: 0px; left: 0px;"></div></div></li>
			
			
			
			<li comp-drag="" comp-rotate="" class="comp-resize comp-rotate inside wsite-image" id="inside_1014494080" num="1" ctype="4" comp-resize="" data-event="1120601" style="width: 300px; height: 100px; left: 141px; top: 28px; z-index: 6; transform: rotateZ(0deg);"><div class="element-box" style="box-shadow: rgba(0, 0, 0, 0.5) 0px 0px 0px; border-color: rgb(0, 0, 0); padding-bottom: 0px; border-style: solid; z-index: 6; height: 100%; text-align: left; border-radius: 0px; left: 141px; font-size: 12px; color: rgb(103, 103, 103); transform: none; top: 28px; border-width: 0px; padding-top: 0px; letter-spacing: 0px; width: 100%; line-height: 1; opacity: 1;">
				<h1>主流平台MCN机构你必须知道.pdf</h1>
				<div class="element-box-contents" style="width: 100%; height: 100%;"  index='pdf' data-index='3'><img id="1014494080" ctype="4" class="element comp_image editable-image" src="" style="cursor: inherit; border-radius: 0px; width: 100%; height: 100%; position: absolute; top: 0px; left: 0px;"></div></div></li>
		
		
			</ul></div></div></section></div>
            
        </div></div>
        
        
    </div>


<script type="text/javascript" >


var loadScript = function (options, callback) { //请求js 并回调
    if (typeof options !== 'object') { return; }
    var src = options.src || '',
      id = options.id || 'script01';

    var preScript = document.getElementById(id);
    if (!!preScript) { 
      callback();
    } else {
      var script = document.createElement('script'),
        head = document.getElementsByTagName('head')[0];
      script.type = 'text/javascript';
      script.charset = 'UTF-8';
      script.src = src;
      script.id = id;
	  try{
	  
	    if (script.addEventListener) {
			script.addEventListener('load', function () {
			  callback();
			}, false);
		} else if (script.attachEvent) {
			script.attachEvent('onreadystatechange', function () {
			  var target = window.event.srcElement;
			  if (target.readyState == 'loaded') {
				callback();
			  }
			});
		  }
	  
	  }catch(e){
	  
	  
	  }
    
      head.appendChild(script);
    }
  }






var urlList = [
'http://storage.xuetangx.com/public_assets/xuetangx/PDF/PlayerAPI_v1.0.6.pdf',
'https://shrydj--edu--sh--cn.hypdncy.com/districtPlatform/qingpu/static/1.pdf',
'https://pdfobject.com/pdf/sample-3pp.pdf',
'https://axhl-test-1252661357.cos.ap-shanghai.myqcloud.com/pdf/1536742627489-310270d9-4e12-2640-8cb6-cfc07a6f6d1b.pdf',
'http://api.idocv.com/data/doc/manual.docx',
'http://campus.51job.com/m/xxzhjt2020/file/1.docx',
'http://www.xdocin.com/demo/demo.docx',
'https://eform.adsale.com.hk/temp_files/CPS20/BEX/Form17B_OverseasExhibitsMove-inoutInstructions.docx',
'https://moonlajs.github.io/web/pdfwordpreview/Year-4-Term-3-Newsletter-North-Sydney-Public-School.docx',
'http://storage.xuetangx.com/public_assets/xuetangx/PDF/1.xls']  ;
  var urls = ['https://pdfobject.com/pdf/sample-3pp.pdf',
'https://axhl-test-1252661357.cos.ap-shanghai.myqcloud.com/pdf/1536742627489-310270d9-4e12-2640-8cb6-cfc07a6f6d1b.pdf'
  ]
  
  var urlsList = [
'https://minio.cnbabylon.com/babylon1/1-太平人寿个人业务系列2016年第十四届业务精英高峰会荣誉方案.pdf',
'https://minio.cnbabylon.com/babylon1/个险每日聚焦0525.pdf',
'https://minio.cnbabylon.com/babylon1/主流平台MCN机构你必须知道.pdf'
  ]
  var url = 'http://storage.xuetangx.com/public_assets/xuetangx/PDF/PlayerAPI_v1.0.6.pdf'
 

var pdfDoc = null;

var nr = document.getElementById('nr')
 var scroll = document.getElementsByClassName('scroll')[0]
var contents = nr.getElementsByClassName('element-box-contents')

for( var ii in contents){
		contents[ii].onclick = function(ii){
			return function(e){
			
			
				var index = e.currentTarget.getAttribute('index')
				if(index === 'pdf'){
					loadScript({
						id:'pdf-min',
						src:'https://unpkg.com/pdfjs-dist@1.9.426/build/pdf.min.js'
					},function(){
						PDFJS.cMapUrl = 'https://unpkg.com/pdfjs-dist@1.9.426/cmaps/';
						PDFJS.cMapPacked = true;
		 
						createPDFcontents(function(div){
							PDFJS.getDocument(urlsList[ii]).then(function (pdf) {
							  pdfDoc = pdf;
							  for (var i = 1; i <= pdfDoc.numPages; i++) {
								renderPage(i,div)
							  }
							});
						})
					})
				
				}else if(index === 'word'){
				
				var wordurl = 'https://view.officeapps.live.com/op/view.aspx?src=https://eform.adsale.com.hk/temp_files/CPS20/BEX/Form17B_OverseasExhibitsMove-inoutInstructions.docx'
				createwordcontents(wordurl,function(){
				
				})
				
				}else{
			
				createwordcontents('https://campus.51job.com/m/xxzhjt2020/file/1.docx',function(){
				
				})
				
				
				
				}
				
				
				
				
				
			}
		}(ii)
		
	}
	
function  createwordcontents(url,callback){
var iframe
	try{  
	   iframe = document.createElement('<iframe name="ifr"></iframe>');  
	 }catch(e){ 
	   iframe = document.createElement('iframe');  
	   iframe.name = 'ifr';  
	}
 var div = document.createElement("div");
	div.setAttribute('class','handout_wrap_inner-4345');
	div.style.top = 0;
	div.style.left = 0;
	div.style.right = 0;
	div.style.bottom = 0;
	div.style.zIndex = '9999999';
	div.style.position = 'fixed';
	div.style.background = '#fff';
	
	div.style.overflowY = 'hidden';
	div.style.overflowX = 'hidden';
	
iframe.seamless = 'seamless';  
iframe.style.height = '100%'; 
iframe.style.width = '100%'; 

//iframe.src = 'https://view.officeapps.live.com/op/view.aspx?src=' + url; 
  iframe.src = url;
// iframe.src= 'https://segmentfault.com/'
 // iframe.src= 'https://www.qq.com/'
//iframe.sandbox = 'allow-scripts allow-top-navigation allow-same-origin allow-forms'; 

	function iframeFinished(){
	    var cssLink = document.createElement("link");

	    //cssLink.href = "style.css";

	    cssLink.rel = "stylesheet";

	    cssLink.type = "text/css";
	    cssLink.innerHTML = `.pdf-preview-iiiiii::before{content:"\\2716"}`;
	    //frames['ifr'].document.body.appendChild(cssLink);
	
console.log('1111111-------','iframeFinished',frames['ifr'])
	
	}



 if (iframe.attachEvent) {
        iframe.attachEvent("onload", iframeFinished);
    } else {
        iframe.onload = iframeFinished;
    }

div.appendChild(iframe);
scroll.appendChild(div);
}






function  createPDFcontents(callback){

 var div = document.createElement("div");
	div.setAttribute('id','handout_wrap_inner');
	div.style.width = '100%';
	div.style.top = 0;
	div.style.left = 0;
	div.style.right = 0;
	div.style.zIndex = '9999999';
	div.style.position = 'absolute';
	div.style.background = '#9E9E9E';
	div.style.overflow = 'hidden';
	var bar = document.createElement("div");
	var title = document.createTextNode("Hi there and greetings!"); 
	bar.style.width = '100%';
	bar.style.height = '5vw';
	bar.className='bar'
	bar.style.position = 'relative';
	bar.style.background = '#9E9E9E';
	bar.style.display = 'flex';
	bar.style.justifyContent = 'flex-end';
	bar.style.alignItems = 'center';
	   
	var close = document.createElement("div");
	close.className='close'
	close.style.fontSize = '4vw';
	close.style.position = 'absolute';
	close.style.right = 0;
	close.style.top = 0;
	//close.style.border='1px solid';
	close.style.textAlign='center';
	close.style.width='4vw';
   
	close.onclick = function(){

		document.body.removeChild(div)

	}
		
	
	
	//header.appendChild(title); 
	//bar.appendChild(close); 
	div.appendChild(close);
	document.body.appendChild(div);
		callback(div)

}



function createPage(div) {

  var canvas = document.createElement("canvas");
  
  div.appendChild(canvas);
 
  return canvas;
}
 
function renderPage(num,div) {
  pdfDoc.getPage(num).then(function (page) {
    var viewport = page.getViewport(2.0);
    var canvas = createPage(div);
    var ctx = canvas.getContext('2d');
 
    canvas.height = viewport.height;
    canvas.width = viewport.width;
 
    page.render({
      canvasContext: ctx,
      viewport: viewport
    });
  });
}
 

  
  
  
  </script>
<script>(function () { var script = document.createElement('script'); script.src="//cdn.jsdelivr.net/npm/eruda"; document.body.appendChild(script); script.onload = function () { eruda.init() } })();</script>
</body>
</html>
